<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Producto - Level-Up</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../assets/css/styles.css">
</head>
<body>
<header>
  <nav>
    <a href="../index.html" class="logo">Level-Up</a>
    <ul class="nav-links">
      <li><a href="../index.html">Inicio</a></li>
      <li><a href="productos.html">Productos</a></li>
      <li><a href="blog.html">Blog</a></li>
      <li><a href="contacto.html">Contacto</a></li>
    </ul>
    <div id="auth-buttons"></div>
  </nav>
</header>

<section class="products-section">
  <div class="container">
    <div class="product-card" id="product-detail" style="max-width:600px;margin:0 auto"></div>
  </div>
</section>

<footer>
  <div class="container">
    <div class="footer-content">
      <div class="footer-section">
        <h4>Level-Up</h4>
        <p>Tu tienda gamer de confianza</p>
      </div>
      <div class="footer-section">
        <h4>Enlaces RÃ¡pidos</h4>
        <ul>
          <li><a href="#inicio">Inicio</a></li>
          <li><a href="#productos">Productos</a></li>
          <li><a href="blog.html">Blog</a></li>
          <li><a href="contacto.html">Contacto</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h4>Contacto</h4>
        <p>Email: info@Level-Up.com</p>
        <p>TelÃ©fono: +56 9 1234 5678</p>
      </div>
      <div class="footer-section">
        <h4>SÃ­guenos</h4>
        <div class="social-links">
          <a href="#">Facebook</a>
          <a href="#">Instagram</a>
          <a href="#">Twitter</a>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; 2025 Level-Up. Todos los derechos reservados.</p>
    </div>
  </div>
</footer>


<script src="../assets/js/auth.js"></script>
<script src="../assets/js/products.js"></script>
<script>
document.addEventListener("DOMContentLoaded", ()=>{
  const authDiv = document.getElementById('auth-buttons');
  const u = window.GZAuth.currentUser();
  if(u){
    authDiv.innerHTML = `<button class="cart-btn" onclick="location.href='carrito.html'">ðŸ›’ Carrito</button><button class="btn-secondary" id="logout">Salir</button>`;
    document.getElementById('logout').onclick = ()=>{ GZAuth.logout(); location.href='index.html'; };
  }else{
    authDiv.innerHTML = `<button class="cart-btn" onclick="location.href='login.html'">Iniciar sesiÃ³n</button><button class="btn-secondary" onclick="location.href='register.html'">Registrarse</button>`;
  }

  const params = new URLSearchParams(location.search);
  const code = params.get('code');
  const prod = GZProducts.list().find(p=>p.code===code);
  if(!prod){
    document.getElementById('product-detail').innerHTML = "<p>No se encontrÃ³ el producto.</p>";
    return;
  }

  const price = u && u.email.endsWith('@duocuc.cl') ? Math.round(prod.price*0.8) : prod.price;
  document.getElementById('product-detail').innerHTML = `
  <div class="product-image">
  <img src="../${prod.img}" alt="${prod.name}">
  </div>
  <div class="product-info">
    <h2 class="product-title">${prod.name}</h2>
    <p class="product-description">${prod.longDescription || prod.description}</p>
    <p class="product-price">${new Intl.NumberFormat('es-CL',{style:'currency',currency:'CLP'}).format(price)}</p>
    <button class="add-to-cart">Agregar al carrito</button>
  </div>`;


  document.querySelector('.add-to-cart').onclick = ()=>{
    const cart = JSON.parse(localStorage.getItem('gz_cart')||'[]');
    const existing = cart.find(i=>i.code===prod.code);
    if(existing){ existing.qty += 1; } else { cart.push({code:prod.code, name:prod.name, price:price, qty:1}); }
    localStorage.setItem('gz_cart', JSON.stringify(cart));
    alert('AÃ±adido al carrito');
  };
});
</script>
</body>
</html>